@{
	ViewData["Title"] = "Home";
	Layout = "_Layout";
}

<div class="container-fluid py-3">
	<h2 class="text-center mb-3">Welcome to Our School</h2>
	<div class="row g-3 mb-4">
		<div class="col-12 col-md-6">
			<img src="~/Images/SchoolMainImage1.png" alt="School Image 1" class="school-img rounded shadow">
		</div>
		<div class="col-12 col-md-6">
			<img src="~/Images/SchoolMainImage2.png" alt="School Image 2" class="school-img rounded shadow">
		</div>
	</div>

	<div class="row g-3">
		<!-- Expense Pie Chart -->
		<div class="col-12 col-lg-6">
			<div class="card shadow h-100">
				<div class="card-header bg-primary text-white py-2">
					<h5 class="mb-0">Monthly Expenses Distribution</h5>
				</div>
				<div class="card-body p-2">
					<canvas id="expenseChart" class="chart-canvas"></canvas>
				</div>
			</div>
		</div>

		<!-- Student Bar Chart -->
		<div class="col-12 col-lg-6">
			<div class="card shadow h-100">
				<div class="card-header bg-success text-white py-2">
					<h5 class="mb-0">Students by Class & Gender</h5>
				</div>
				<div class="card-body p-2">
					<canvas id="studentChart" class="chart-canvas"></canvas>
				</div>
			</div>
		</div>
	</div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
		document.addEventListener('DOMContentLoaded', function() {
			// Expense Pie Chart
			const expenseCtx = document.getElementById('expenseChart').getContext('2d');
			new Chart(expenseCtx, {
				type: 'pie',
				data: {
					labels: ['Salaries', 'Infrastructure', 'Utilities', 'Activities', 'Maintenance', 'Others'],
					datasets: [{
						data: [45, 20, 15, 10, 5, 5],
						backgroundColor: [
							'#4e73df',
							'#1cc88a',
							'#36b9cc',
							'#f6c23e',
							'#e74a3b',
							'#858796'
						],
						hoverOffset: 4
					}]
				},
				options: {
					responsive: true,
					plugins: {
						legend: {
							position: 'bottom',
						},
						tooltip: {
							callbacks: {
								label: function(context) {
									const label = context.label || '';
									const value = context.raw || 0;
									const total = context.dataset.data.reduce((a, b) => a + b, 0);
									const percentage = Math.round((value / total) * 100);
									return `${label}: ${percentage}% (â‚¹${value.toLocaleString()}K)`;
								}
							}
						}
					}
				}
			});

			// Student Bar Chart
			const studentCtx = document.getElementById('studentChart').getContext('2d');
			new Chart(studentCtx, {
				type: 'bar',
				data: {
					labels: ['Nursery', 'LKG', 'UKG', 'I', 'II', 'III', 'IV', 'V'],
					datasets: [
						{
							label: 'Boys',
							data: [25, 28, 30, 32, 35, 34, 36, 38],
							backgroundColor: '#4e73df',
							borderWidth: 0
						},
						{
							label: 'Girls',
							data: [23, 26, 28, 30, 32, 34, 33, 35],
							backgroundColor: '#e74a3b',
							borderWidth: 0
						}
					]
				},
				options: {
					responsive: true,
					scales: {
						x: {
							grid: {
								display: false
							}
						},
						y: {
							beginAtZero: true,
							ticks: {
								stepSize: 10
							}
						}
					},
					plugins: {
						legend: {
							position: 'bottom',
						},
						tooltip: {
							callbacks: {
								label: function(context) {
									return `${context.dataset.label}: ${context.raw} students`;
								}
							}
						}
					}
				}
			});
		});
    </script>
}

<style>
	.school-img {
		height: 200px;
		width: 100%;
		object-fit: cover;
	}

	.chart-canvas {
		width: 100% !important;
		height: 300px !important;
	}

	.card {
		border: none;
		border-radius: 0.5rem;
		overflow: hidden;
		height: 100%;
		display: flex;
		flex-direction: column;
	}

	.card-body {
		flex: 1;
		display: flex;
		flex-direction: column;
	}

	.card-body canvas {
		flex: 1;
	}

	.shadow {
		box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1) !important;
	}

	.card-header {
		font-weight: 600;
		padding: 0.5rem 1rem;
	}

	/* Responsive adjustments */
	@@media (max-width: 768px) {
		.school-img {
			height: 150px;
		}

		.chart-canvas {
			height: 250px !important;
		}
	}
</style>
